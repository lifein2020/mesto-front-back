(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{29:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),s=n(18),i=n.n(s),o=(n(29),n(23)),r=n(2),u=n(3),l=n(12),p=n(19),d=n(20),j=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(p.a)(this,e),this.baseUrl=n,this.headers=a}return Object(d.a)(e,[{key:"_getResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"_getHeaders",value:function(){var e=localStorage.getItem("jwt");return Object(l.a)(Object(l.a)({},this.headers),{},{Authorization:"Bearer ".concat(e)})}},{key:"getUserInfo",value:function(){return fetch(this.baseUrl+"users/me",{headers:this._getHeaders()}).then(this._getResponse)}},{key:"getCardsList",value:function(){return fetch(this.baseUrl+"cards",{headers:this._getHeaders()}).then(this._getResponse)}},{key:"postAddCard",value:function(e){var t=e.card_name,n=e.card_image_link;return fetch("".concat(this.baseUrl,"cards"),{method:"POST",body:JSON.stringify({name:t,link:n}),headers:this._getHeaders()}).then(this._getResponse)}},{key:"patchUserInfo",value:function(e){var t=e.userName,n=e.userDescription;return fetch(this.baseUrl+"users/me",{method:"PATCH",body:JSON.stringify({name:t,about:n}),headers:this._getHeaders()}).then(this._getResponse)}},{key:"patchAvatarUser",value:function(e){var t=e.avatarUrl;return fetch(this.baseUrl+"users/me/avatar",{method:"PATCH",body:JSON.stringify({avatar:t}),headers:this._getHeaders()}).then(this._getResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this.baseUrl,"cards/").concat(e),{method:"DELETE",headers:this._getHeaders()}).then(this._getResponse)}},{key:"changeLikeCardStatus",value:function(e,t){return fetch("".concat(this.baseUrl,"cards/").concat(e,"/likes"),{method:t?"DELETE":"PUT",headers:this._getHeaders()}).then(this._getResponse)}}]),e}())({baseUrl:"http://localhost:3005/",headers:{"Content-Type":"application/json"}}),m=c.a.createContext(),b=n.p+"static/media/kusto.91fa6d23.jpg",h=n(0);var _=function(e){return Object(h.jsx)("div",{className:e.isOpen?"popup popup_type_".concat(e.name," popup_is-opened"):"popup popup_type_".concat(e.name),children:Object(h.jsxs)("div",{className:"popup__container popup__container_".concat(e.name),children:[Object(h.jsx)("button",{type:"button",className:"popup__close popup__close_".concat(e.name),onClick:e.onClose}),Object(h.jsx)("h2",{className:"popup__title",children:e.title}),Object(h.jsxs)("form",{name:e.name,id:e.id,className:"popup__form popup__form_".concat(e.name),action:"#",autoComplete:"off",onSubmit:e.onSubmit,children:[e.children,Object(h.jsx)("button",{type:"submit",className:"popup__button popup__".concat(e.button),children:e.titleButton})]})]})})};var f=function(e){var t=e.isOpen,n=e.onClose,s=e.onUpdateUser,i=Object(a.useState)(""),o=Object(r.a)(i,2),u=o[0],l=o[1],p=Object(a.useState)(""),d=Object(r.a)(p,2),j=d[0],b=d[1],f=c.a.useContext(m);return Object(a.useEffect)((function(){l(f.name),b(f.about)}),[f,t]),Object(h.jsxs)(_,{name:"edit",id:"formEdit",title:"Edit profile",button:"save",titleButton:"Save",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),s({userName:u,userDescription:j})},children:[Object(h.jsx)("input",{type:"text",className:"popup__input popup__input_user_name",id:"name-input",name:"name",required:!0,placeholder:"Name",minLength:"2",maxLength:"40",value:u||"",onChange:function(e){l(e.target.value)}}),Object(h.jsx)("span",{className:"popup__error name-input-error"}),Object(h.jsx)("input",{type:"text",className:"popup__input popup__input_user_job",id:"job-input",name:"job",required:!0,placeholder:"Activity",minLength:"2",maxLength:"200",value:j||"",onChange:function(e){b(e.target.value)}}),Object(h.jsx)("span",{className:"popup__error job-input-error"})]})};var O=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateAvatar,s=Object(a.useRef)();return Object(a.useEffect)((function(){s.current.value=""}),[t]),Object(h.jsxs)(_,{name:"avatar",id:"formAvatar",title:"Update avatar",button:"save",titleButton:"Save",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({avatarUrl:s.current.value}),s.current.value=""},children:[Object(h.jsx)("input",{type:"url",className:"popup__input popup__input_avatar_link",id:"avatar-link-input",name:"avatar_link",autoComplete:"on",required:!0,placeholder:"Link to the avatar",ref:s}),Object(h.jsx)("span",{className:"popup__error avatar-link-input-error"})]})};var g=function(e){var t=e.isOpen,n=e.onClose,c=e.onAddPlace,s=Object(a.useState)(""),i=Object(r.a)(s,2),o=i[0],u=i[1],l=Object(a.useState)(""),p=Object(r.a)(l,2),d=p[0],j=p[1];return Object(h.jsxs)(_,{name:"add-card",id:"formAdd",title:"New place",button:"button_disabled",titleButton:"Create",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({card_name:o,card_image_link:d}),u(""),j("")},children:[Object(h.jsx)("input",{type:"text",className:"popup__input popup__input_card_name",id:"card-name-input",name:"card_name",autoComplete:"off",required:!0,placeholder:"Title",minLength:"2",maxLength:"30",value:o,onChange:function(e){u(e.target.value)}}),Object(h.jsx)("span",{className:"popup__error card-name-input-error"}),Object(h.jsx)("input",{type:"url",className:"popup__input popup__input_card_image-link",id:"card-image-link-input",name:"card_image_link",autoComplete:"on",required:!0,placeholder:"Link to the picture",value:d,onChange:function(e){j(e.target.value)}}),Object(h.jsx)("span",{className:"popup__error card-image-link-input-error"})]})};var v=function(e){var t=e.card,n=e.onClose,a=e.active;return Object(h.jsx)("div",{className:t&&a?"popup popup_type_image popup_is-opened":"popup popup_type_image",children:Object(h.jsxs)("div",{className:"popup__container-image",children:[Object(h.jsx)("button",{type:"button",className:"popup__close popup__close_image",onClick:n}),Object(h.jsx)("img",{className:"popup__image",src:t.link,alt:t.name}),Object(h.jsx)("h2",{className:"popup__title-image",children:t.name})]})})},x=n(8);var A=function(e){var t=e.onSignOut,n=e.email;return Object(h.jsxs)("header",{className:"header",children:[Object(h.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAI4AAAAhCAMAAAA4aWMBAAAAPFBMVEUAAAD////////////////////////////////////////////////////////////////////////////YSWgTAAAAE3RSTlMAIJ9AgN+/72CQEAEwz69BcFBvIc9UfgAAAwBJREFUWMPFl4tu6yAMhm3A3BJoSN7/XU/cAiZbtImzqfulrIlXw4cvhML7tFprs4c7mQxv18NpXUjDjXCFt+tBALApMAh8RaM8B0YFhFIAdr55kwQnLFbDeS0p6GyWELTJYAyYXLyL8D49nPeBsOE4jsWSN4B44vDfJb0jZ4JjjGOU11UoBYSVSCHjrIrS+V/Qpz5RrWyNv58skxsOTxIsl/FGJ85CLysep9xHV2Ir/j5OdHpRAR6HXizCbpeMgIzDuVuPinN+XuSPeRw0xuiv951XZ2FySmkwiU6iQkQe9h08kVUNx1497X/g6NPDwA9VcY71avtjnOtA6s9xLjsQ/S2OO6/tWshuxEHDgEmNfDqwjZQGVrQ28aO11nen9HTS0zjKXYo58TQDzn40qRbDmAebxFjSvoRuyDiLY8ZeX8+HMOCoQ5RiIxbZG5xldCKcxIlMMBYyCg6jOrPi6ql/y/Mk+4n2tHmAqPXGA2mtsTrxU3VKkzhguZjFkKHjoCwPqQXRdljseX60yLRgaXEykzhaiplXXgRHDXnULTx0IlZb8Wv8iLOoet/sbhIHXA1pnUpwaKxyWzHoZhsYcdywcyyWFzSJ04uZI+AFZ72Emtsl1k/yeItTnTI0bRz5SZzoniNUDsFhumSbWlTQHaykPN7hlHorcGoSBzIvvD0Kjj9Ew16tqbe+/4zjL/HAaRzZ43kk/T0OoOlANn6Pk2dxnr3eCllwyrOU7j1LsE+efJesIFmcjk6rOF1nFxyUkW+9DfPEjiNj2h+V8quYba4U0uhs/cq/tvGvNnrv4vYgOGEczGZTnmduRc2WR5xQCcKHHZpgHkcP58LrS8LVdjZD2aco7wBs/WzHl4SXL/hJHDkhJxAcCZrSiMX2xuIpqCDgTt09OjaagBye6rRq4yQ4kzibrAluDxg9BasbTCSxY20/P2BAXx/BFUfmYbnSdlrqNosgFSODiZOd+fkYlVIttV6pTW5V7Mi7ZdK8DwP7nE68FDSItEqUzOjkKGiY0D+3WkqFJF6wAgAAAABJRU5ErkJggg==",className:"header__logo",alt:"\u041b\u043e\u0442\u043e\u0442\u0438\u043f \u043f\u0440\u043e\u0435\u043a\u0442\u0430 \u041c\u0435\u0441\u0442\u043e"}),Object(h.jsx)(u.b,{path:"/sign-up",children:Object(h.jsx)(x.b,{className:"header__sign-link",to:"sign-in",children:"Sign in"})}),Object(h.jsx)(u.b,{path:"/sign-in",children:Object(h.jsx)(x.b,{className:"header__sign-link",to:"sign-up",children:"Sign up"})}),Object(h.jsx)(u.b,{exact:!0,path:"/",children:Object(h.jsxs)("div",{className:"header__container",children:[Object(h.jsx)("p",{className:"header__user-email",children:n}),Object(h.jsx)("button",{className:"header__logout",onClick:function(){t()},children:"Sign out"})]})})]})};var C=function(e){var t=c.a.useContext(m),n=e.card.owner===t._id,a="element__trash ".concat(n?"element__trash_visible":"element__trash"),s=e.card.likes.some((function(e){return e===t._id})),i="element__like ".concat(s?"element__like_active":"element__like"),o=e.card.likes.length;return Object(h.jsxs)("article",{className:"element",children:[Object(h.jsx)("img",{className:"element__image",src:e.card.link,alt:e.card.name,onClick:function(){e.onCardClick(e.card)}}),Object(h.jsx)("button",{className:a,type:"button",onClick:function(){e.onCardDelete(e.card)}}),Object(h.jsxs)("div",{className:"element__text",children:[Object(h.jsx)("h2",{className:"element__title",children:e.card.name}),Object(h.jsxs)("div",{className:"element__group",children:[Object(h.jsx)("button",{className:i,type:"button",onClick:function(){e.onCardLike(e.card)}}),Object(h.jsx)("div",{className:"element__count",children:o})]})]})]})};var k=function(e){var t=c.a.useContext(m);return Object(h.jsxs)("main",{className:"content",children:[Object(h.jsxs)("nav",{className:"profile",children:[Object(h.jsxs)("div",{className:"profile__container",children:[Object(h.jsx)("img",{className:"profile__avatar",src:t.avatar,alt:t.name}),Object(h.jsx)("div",{className:"profile__overlay",onClick:e.onEditAvatar,children:Object(h.jsx)("img",{className:"profile__pen",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUBAMAAAB/pwA+AAAAJ1BMVEUAAAD///////////////////////////////////////////////+uPUo5AAAADHRSTlMAMO/fIBDPwJBvQH+Dp3+dAAAAPklEQVQI12OAAfEAGItRJxXGFDpzHC54RhEueEiAAkFnuCCLDbGCDGFwQU7WJJjgmg2BMIf2nIR7pGIBjAUAta0Z8ZQ5LvMAAAAASUVORK5CYII=",alt:"Pencil"})})]}),Object(h.jsxs)("div",{className:"profile-info",children:[Object(h.jsxs)("div",{className:"profile-info__container",children:[Object(h.jsx)("h1",{className:"profile-info__name",children:t.name}),Object(h.jsx)("button",{className:"profile-info__edit-button",type:"button",name:"send",onClick:e.onEditProfile})]}),Object(h.jsx)("p",{className:"profile-info__activity",children:t.about})]}),Object(h.jsx)("button",{className:"profile__add-button",type:"button",onClick:e.onAddPlace})]}),Object(h.jsx)("section",{className:"elements",children:e.cards.map((function(t){return Object(h.jsx)(C,{card:t,onCardClick:e.onCardClick,onCardLike:e.onLikeClick,onCardDelete:e.onDeleteClick},t._id)}))})]})};var N=function(){return Object(h.jsx)("footer",{className:"footer",children:Object(h.jsx)("h3",{className:"footer__title",children:"\xa9 2022 Mesto Russia"})})};var S=function(e){var t=e.onRegister,n=Object(a.useState)(""),c=Object(r.a)(n,2),s=c[0],i=c[1],o=Object(a.useState)(""),l=Object(r.a)(o,2),p=l[0],d=l[1];return Object(h.jsxs)("div",{className:"form",children:[Object(h.jsx)("h2",{className:"form__title",children:"Sign up"}),Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({password:p,email:s}),i(""),d("")},children:[Object(h.jsx)("input",{type:"email",className:"form__input",id:"email-input",name:"email",autoComplete:"on",required:!0,placeholder:"Email",value:s||"",onChange:function(e){i(e.target.value)}}),Object(h.jsx)("input",{type:"password",className:"form__input",id:"password-input",name:"password",autoComplete:"off",required:!0,placeholder:"Password",value:p||"",onChange:function(e){d(e.target.value)}}),Object(h.jsx)("button",{type:"submit",className:"form__button",children:"Sign up"})]}),Object(h.jsx)(u.b,{path:"/sign-up",children:Object(h.jsx)("div",{className:"form__link",children:Object(h.jsx)(x.b,{className:"form__link_sign",to:"sign-in",children:"Already registered? Sign in"})})})]})};var y=function(e){var t=e.onLogin,n=Object(a.useState)(""),c=Object(r.a)(n,2),s=c[0],i=c[1],o=Object(a.useState)(""),u=Object(r.a)(o,2),l=u[0],p=u[1];return Object(h.jsxs)("div",{className:"form",children:[Object(h.jsx)("h2",{className:"form__title",children:"Sign in"}),Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({password:l,email:s}),i(""),p("")},children:[Object(h.jsx)("input",{type:"email",className:"form__input",id:"email-input",name:"email",autoComplete:"on",required:!0,placeholder:"Email",value:s||"",onChange:function(e){i(e.target.value)}}),Object(h.jsx)("input",{type:"password",className:"form__input",id:"password-input",name:"password",autoComplete:"off",required:!0,placeholder:"Password",value:l||"",onChange:function(e){p(e.target.value)}}),Object(h.jsx)("button",{type:"submit",className:"form__button",children:"Enter"})]})]})};var U=function(e){var t=e.isOpen,n=e.onClose,a=e.message;return Object(h.jsx)("div",{className:t?"popup popup_type_infoTooltip popup_is-opened":"popup popup_type_infoTooltip",children:Object(h.jsxs)("div",{className:"popup__container popup__container_infoTooltip",children:[Object(h.jsx)("button",{type:"button",className:"popup__close popup__close_infoTooltip",onClick:n}),Object(h.jsx)("img",{className:"popup__container_image",src:a.image,alt:a.image}),Object(h.jsx)("h2",{className:"popup__title_sign",children:a.text})]})})},E=n(24),w=["component"],D=function(e){var t=e.component,n=Object(E.a)(e,w);return Object(h.jsx)(u.b,{exact:!0,children:function(){return n.loggedIn?Object(h.jsx)(t,Object(l.a)({},n)):Object(h.jsx)(u.a,{to:"./sign-in"})}})},L="http://localhost:3005",I=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))},P=n.p+"static/media/success.1b6082f8.svg",T=n.p+"static/media/fail.df8eddf6.svg";var B=function(){var e=Object(a.useState)(!1),t=Object(r.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(!1),i=Object(r.a)(s,2),l=i[0],p=i[1],d=Object(a.useState)(!1),x=Object(r.a)(d,2),C=x[0],E=x[1],w=Object(a.useState)({}),B=Object(r.a)(w,2),R=B[0],H=B[1],F=Object(a.useState)(!1),J=Object(r.a)(F,2),q=J[0],M=J[1],z=Object(a.useState)(!1),X=Object(r.a)(z,2),Q=X[0],Z=X[1],G=Object(a.useState)({image:"",text:""}),V=Object(r.a)(G,2),Y=V[0],W=V[1],K=function(){c(!1),p(!1),E(!1),H({}),M(!1),Z(!1)},$=Object(a.useState)({name:"Jacques-Yves Cousteau",about:"Ocean explorer",avatar:b}),ee=Object(r.a)($,2),te=ee[0],ne=ee[1],ae=Object(a.useState)([]),ce=Object(r.a)(ae,2),se=ce[0],ie=ce[1];Object(a.useEffect)((function(){var e=function(e){"Escape"===e.key&&K()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[]),Object(a.useEffect)((function(){var e=function(e){(e.target.classList.contains("popup")||e.target.classList.contains("popup__close"))&&K()};return document.addEventListener("click",e),function(){return document.removeEventListener("click",e)}}),[]);var oe=Object(a.useState)(!1),re=Object(r.a)(oe,2),ue=re[0],le=re[1],pe=Object(a.useState)("email"),de=Object(r.a)(pe,2),je=de[0],me=de[1],be=Object(u.g)(),he=function(e){return(t=e,fetch("".concat(L,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then(I)).then((function(e){e&&le(!0)})).catch((function(e){return console.log(e)}));var t};return Object(a.useEffect)((function(){var e=localStorage.getItem("jwt");e&&he(e)}),[ue]),Object(a.useEffect)((function(){ue&&(be.push("/"),Promise.all([j.getUserInfo(),j.getCardsList()]).then((function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1];ne({name:n.data.name,about:n.data.about,avatar:n.data.avatar,_id:n.data._id}),ie(a.data),me(n.data.email)})).catch((function(e){console.log(e)})))}),[ue,be]),Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{className:"page",children:Object(h.jsxs)(m.Provider,{value:te,children:[Object(h.jsx)(A,{onSignOut:function(){localStorage.removeItem("jwt"),le(!1),be.push("/login")},email:je}),Object(h.jsxs)(u.d,{children:[Object(h.jsx)(D,{exact:!0,path:"/",loggedIn:ue,component:k,onEditProfile:function(){c(!0)},onAddPlace:function(){p(!0)},onEditAvatar:function(){E(!0)},cards:se,onCardClick:function(e){H(e),M(!0)},onLikeClick:function(e){var t=e.likes.some((function(e){return e===te._id}));j.changeLikeCardStatus(e._id,t).then((function(t){var n=se.map((function(n){return n._id===e._id?t.card:n}));ie(n)})).catch((function(e){console.log(e)}))},onDeleteClick:function(e){j.deleteCard(e._id).then((function(){ie((function(t){return t.filter((function(t){return t._id!==e._id}))}))})).catch((function(e){console.log(e)}))}}),Object(h.jsx)(u.b,{path:"/sign-up",children:Object(h.jsx)(S,{onRegister:function(e){return function(e,t){return fetch("".concat(L,"/sign-up"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then(I)}(e.password,e.email).then((function(e){console.log(e),(e.data._id||400!==e.statusCode)&&(be.push("/sign-in"),Z(!0),W({image:P,text:"You have successfully registered!"}))})).catch((function(e){Z(!0),W({image:T,text:"Something went wrong! Try again."})}))}})}),Object(h.jsx)(u.b,{path:"/sign-in",children:Object(h.jsx)(y,{onLogin:function(e){return function(e,t){return fetch("".concat(L,"/sign-in"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then(I)}(e.password,e.email).then((function(e){e.token&&(le(!0),localStorage.setItem("jwt",e.token),be.push("/"))})).catch((function(e){Z(!0),W({image:T,text:"Something went wrong! Try again."})}))}})}),Object(h.jsx)(u.b,{children:ue?Object(h.jsx)(u.a,{to:"/sign-in"}):Object(h.jsx)(u.a,{to:"/sign-up"})})]}),Object(h.jsx)(N,{}),Object(h.jsx)(f,{isOpen:n,onClose:K,onUpdateUser:function(e){var t=e.userName,n=e.userDescription;j.patchUserInfo({userName:t,userDescription:n}).then((function(e){ne({name:e.data.name,about:e.data.about,avatar:e.data.avatar,likes:e.data.likes,_id:e.data._id})})).then((function(){K()})).catch((function(e){console.log(e)}))}}),Object(h.jsx)(g,{isOpen:l,onClose:K,onAddPlace:function(e){var t=e.card_name,n=e.card_image_link;j.postAddCard({card_name:t,card_image_link:n}).then((function(e){ie([e.data].concat(Object(o.a)(se)))})).then((function(){K()})).catch((function(e){console.log(e)}))}}),Object(h.jsx)(_,{name:"confirm",id:"formConfirm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",button:"button_confirm popup__save",titleButton:"\u0414\u0430",onClose:K}),Object(h.jsx)(O,{isOpen:C,onClose:K,onUpdateAvatar:function(e){var t=e.avatarUrl;j.patchAvatarUser({avatarUrl:t}).then((function(e){ne({avatar:e.data.avatar,name:e.data.name,about:e.data.about,_id:e.data._id})})).then((function(){K()})).catch((function(e){console.log(e)}))}}),Object(h.jsx)(v,{card:R,onClose:K,active:q}),Object(h.jsx)(U,{isOpen:Q,onClose:K,message:Y})]})})})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),s(e),i(e)}))};i.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(x.a,{children:Object(h.jsx)(B,{})})}),document.getElementById("root")),R()}},[[36,1,2]]]);
//# sourceMappingURL=main.2a6ad975.chunk.js.map